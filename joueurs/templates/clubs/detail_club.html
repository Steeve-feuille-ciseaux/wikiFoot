{% extends 'base.html' %}

{% load static %}

{% block title %}{{ club.name }}{% endblock %}

{% block body %}
<div class="container mt-4">
    <h1>{{ club.name }}</h1>

    <div class="row">
        <div class="col-md-4">
            {% if club.blazon %}
                <img src="{{ club.blazon.url }}" alt="Blason de {{ club.name }}" class="img-fluid mb-3">
            {% endif %}
        </div>
        <div class="col-md-8">
            <table class="table">
                <tbody>
                    <tr>
                        <th>Pays</th>
                        <td>{{ club.country.name }}</td>
                    </tr>
                    <tr>
                        <th>Histoire</th>
                        <td>{{ club.story|linebreaksbr }}</td>
                    </tr>
                    {% if club.rival %}
                        <tr>
                            <th>Rival</th>
                            <td>{{ club.rival.name }}</td>
                        </tr>
                    {% endif %}
                    <tr>
                        <th>Stade</th>
                        <td>{{ club.stade }}</td>
                    </tr>
                </tbody>
            </table>

            {% if club.storytelling %}
                <a href="{% url 'story_telling' 'club' club.pk %}" class="btn btn-primary">
                    üìñ Voir l'histoire d√©taill√©e
                </a>
            {% else %}
                <p class="text-muted">‚ùå Pas d'histoire d√©taill√©e</p>
            {% endif %}

        </div>
        {% if user.is_authenticated and user.profile.rank >= 2 %}
            <hr>
            <p>
                {% if club.created_by %}
                    <strong>Cr√©√© par :</strong> {{ club.created_by.user.username }} 
                    <strong>le</strong> {{ club.created_date|date:"d/m/Y H:i" }}<br>
                {% endif %}

                {% if club.updated_by %}
                    <strong>Check√© par :</strong> {{ club.updated_by.user.username }} 
                    <strong>le</strong> {{ club.updated_date|date:"d/m/Y H:i" }}
                {% endif %}
            </p>
        {% endif %}
    </div>

    <div class="mt-3 d-flex gap-2 flex-wrap align-items-center">
        <a href="{% url 'liste_clubs' %}" class="btn btn-secondary">Retour √† la liste</a>

        {% if user.is_authenticated and user.profile.rank >= 3 %}
            <a href="{% url 'modifier_club' club.pk %}" class="btn btn-warning">Modifier</a>

            <form method="post" action="{% url 'club_supprimer' club.pk %}" class="d-inline"
                onsubmit="return confirm('√ätes-vous s√ªr de vouloir supprimer ce club ?');">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger">Supprimer</button>
            </form>

            {% if not club.visible %}
                <a href="{% url 'valider_club' club.pk %}" class="btn btn-success ms-auto">
                    <i class="fas fa-check me-1"></i>Valider
                </a>
            {% endif %}
        {% endif %}
    </div>

</div>
{% endblock %}
